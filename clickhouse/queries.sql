SELECT data.commit.collection AS event, count() AS count FROM bluesky GROUP BY event ORDER BY count DESC;
SELECT data.commit.collection AS event, count() AS count, uniqExact(data.did) AS users FROM bluesky WHERE data.kind = 'commit' AND data.commit.operation = 'create' GROUP BY event ORDER BY count DESC;
SELECT data.commit.collection AS event, toHour(fromUnixTimestamp64Micro(data.time_us)) as hour_of_day, count() AS count FROM bluesky WHERE data.kind = 'commit' AND data.commit.operation = 'create' AND data.commit.collection in ['app.bsky.feed.post', 'app.bsky.feed.repost', 'app.bsky.feed.like'] GROUP BY event, hour_of_day ORDER BY hour_of_day, event;
SELECT data.did::String as user_id, min(fromUnixTimestamp64Micro(data.time_us)) as first_post_ts FROM bluesky WHERE data.kind = 'commit' AND data.commit.operation = 'create' AND data.commit.collection = 'app.bsky.feed.post' GROUP BY user_id ORDER BY first_post_ts ASC LIMIT 3;
SELECT data.did::String as user_id, date_diff( 'milliseconds', min(fromUnixTimestamp64Micro(data.time_us)), max(fromUnixTimestamp64Micro(data.time_us))) AS activity_span FROM bluesky WHERE data.kind = 'commit' AND data.commit.operation = 'create' AND data.commit.collection = 'app.bsky.feed.post' GROUP BY user_id ORDER BY activity_span DESC LIMIT 3;
SELECT data.did AS user_id,MAX(data.kind) AS activity_type,SUM(IF(data.commit.collection = 'app.bsky.feed.post', 1, 0)) AS total_posts,SUM(IF(data.commit.collection = 'app.bsky.feed.like', 1, 0)) AS total_likes,SUM(IF(data.commit.collection = 'app.bsky.feed.repost', 1, 0)) AS total_reposts,SUM(IF(data.commit.collection = 'app.bsky.graph.follow', 1, 0)) AS total_follows,MAX(fromUnixTimestamp64Micro(data.time_us)) AS last_activity_time FROM bluesky GROUP BY data.did;
SELECT data.did AS user_id, toYYYYMM(fromUnixTimestamp64Micro(data.time_us)) AS activity_month,SUM(CASE WHEN data.commit.collection IN ('app.bsky.feed.post', 'app.bsky.feed.repost') THEN 1 ELSE 0 END) AS content_creation_actions,SUM(CASE WHEN data.commit.collection IN ('app.bsky.feed.like', 'app.bsky.graph.follow') THEN 1 ELSE 0 END) AS engagement_actions FROM blueskyGROUP BY data.did,toYYYYMM(fromUnixTimestamp64Micro(data.time_us));